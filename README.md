# CDC Bridge ‚Äî –°–∏—Å—Ç–µ–º–∞ –ó–∞—Ö–≤–∞—Ç–∞ –ò–∑–º–µ–Ω–µ–Ω–∏–π –î–∞–Ω–Ω—ã—Ö

**CDC Bridge** ‚Äî —ç—Ç–æ —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è .NET-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö (Change Data Capture) –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö, –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –¥–æ—Å—Ç–∞–≤–∫–∏ –≤–æ –≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã. –û–Ω–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ —Ä–µ–∂–∏–º–µ 24/7, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –Ω–∞–¥–µ–∂–Ω—É—é –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É —Å–æ–±—ã—Ç–∏–π –∏–∑–º–µ–Ω–µ–Ω–∏–π.

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

*   **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π** –≤ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö (SQL Server –∏ –¥—Ä.) –≤ —Ä–µ–∂–∏–º–µ, –±–ª–∏–∑–∫–æ–º –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏.
*   **–ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è** –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–±–æ–µ–≤ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–≤ —Å–µ—Ä–≤–∏—Å–∞.
*   **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** —Å–æ–±—ã—Ç–∏–π –ø–æ –≥–∏–±–∫–∏–º –ø—Ä–∞–≤–∏–ª–∞–º –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π.
*   **–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è** –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è —Å–∏—Å—Ç–µ–º—ã-–ø–æ–ª—É—á–∞—Ç–µ–ª—è.
*   **–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–∞–Ω–∞–ª—ã (–≤–µ–±—Ö—É–∫–∏ –∏ –¥—Ä.) —Å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—è.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ–æ–Ω–æ–≤—ã—Ö —Å–ª—É–∂–± (.NET Worker Service).

```mermaid
graph TD
    subgraph "–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –î–∞–Ω–Ω—ã—Ö"
        style DB fill:#dae8fc,stroke:#6c8ebf
        DB[(SQL Server DB)]
    end

    subgraph "–Ø–¥—Ä–æ –°–∏—Å—Ç–µ–º—ã (CdcBridge.Service)"
        style Orchestrator fill:#f8cecc,stroke:#b85450
        style Workers fill:#dae8fc,stroke:#6c8ebf
        
        Orchestrator(CdcBridgeOrchestrator) -->|–∑–∞–ø—É—Å–∫–∞–µ—Ç| SW[SourceWorker]
        Orchestrator -->|–∑–∞–ø—É—Å–∫–∞–µ—Ç| RW[ReceiverWorker]
        Orchestrator -->|–∑–∞–ø—É—Å–∫–∞–µ—Ç| CW[CleanupWorker]
    end
    
    subgraph "–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (CdcBridge.Application)"
        style Components fill:#d5e8d4,stroke:#82b366
        
        CdcSource(ICdcSource: SqlServer)
        Filter(IFilter: JsonPath)
        Transformer(ITransformer: JSONata)
        Receiver(IReceiver: Webhook)
    end

    subgraph "–•—Ä–∞–Ω–∏–ª–∏—â–µ –°–æ—Å—Ç–æ—è–Ω–∏—è (CdcBridge.Persistence)"
        style Storage fill:#e1d5e7,stroke:#9673a6
        Storage[ICdcBridgeStorage<br/>(SQLite / EF Core)]
    end

    subgraph "–í–Ω–µ—à–Ω–∏–µ –°–∏—Å—Ç–µ–º—ã"
        style Webhook fill:#ffe6cc,stroke:#d79b00
        Webhook[API / Webhook Listener]
    end

    %% –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
    DB -- 1. CDC --> SW
    SW -- 2. –ß–∏—Ç–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è --> CdcSource
    SW -- 3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –±—É—Ñ–µ—Ä --> Storage
    RW -- 4. –ß–∏—Ç–∞–µ—Ç –∏–∑ –±—É—Ñ–µ—Ä–∞ --> Storage
    RW -- 5. –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä --> Filter
    RW -- 6. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ --> Transformer
    RW -- 7. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ --> Receiver
    Receiver -- 8. HTTP POST --> Webhook
    CW -- 9. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç --> Storage
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

*   **Orchestrator**: –ì–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π —á–∏—Ç–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ –æ–¥–Ω–æ–º—É –≤–æ—Ä–∫–µ—Ä—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (`SourceWorker`) –∏ –ø–æ–ª—É—á–∞—Ç–µ–ª—è (`ReceiverWorker`).
*   **SourceWorker**: –û–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É –≤ SQL Server) –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –Ω–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π –±—É—Ñ–µ—Ä (SQLite).
*   **ReceiverWorker**: –†–∞–±–æ—Ç–∞–µ—Ç —Å –æ–¥–Ω–∏–º –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º. –û–Ω –∑–∞–±–∏—Ä–∞–µ—Ç —Å–≤–æ—é –ø–æ—Ä—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±—É—Ñ–µ—Ä–∞, –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∫ –Ω–∏–º —Ñ–∏–ª—å—Ç—Ä—ã –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã, –∞ –∑–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö. –ö–∞–∂–¥—ã–π `ReceiverWorker` –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å.
*   **CleanupWorker**: –§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç –∏–∑ –±—É—Ñ–µ—Ä–∞ —Å—Ç–∞—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è, —É—Å–ø–µ—à–Ω–æ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤—Å–µ–º –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º.
*   **ICdcBridgeStorage**: –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –Ω–∞–¥ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º (SQLite), –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—é –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
*   **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (`ICdcSource`, `IFilter` –∏ –¥—Ä.)**: –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, —Ñ–∏–ª—å—Ç—Ä–æ–≤, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ –∏ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ YAML-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

## üìñ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞.

### 1. `appsettings.json`

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Å–∞–º–æ–≥–æ .NET-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

```json
{
  "Logging": {
    "LogLevel": {
      "Default": "Information", // –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 'Debug' –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
      "Microsoft.Hosting.Lifetime": "Information",
      "Microsoft.EntityFrameworkCore": "Warning"
    }
  },
  "CdcBridge": {
    "ConfigurationPath": "cdc-settings.yaml", // –ü—É—Ç—å –∫ –≥–ª–∞–≤–Ω–æ–º—É YAML-—Ñ–∞–π–ª—É
    "CleanupIntervalHours": 1 // –ö–∞–∫ —á–∞—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ—á–∏—Å—Ç–∫—É –±—É—Ñ–µ—Ä–∞
  },
  "Persistence": {
    // –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è (–±—É—Ñ–µ—Ä–∞)
    "SqliteDbPath": "data/cdc_bridge.db" 
  },
  "ConnectionStrings": {
    // –°–µ–∫—Ü–∏—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –¥—Ä—É–≥–∏—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤
    "DefaultConnection": "Server=localhost;Database=...;User Id=...;Password=..."
  }
}
```

### 2. `cdc-settings.yaml`

–≠—Ç–æ –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–π –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã CDC Bridge. –û–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –º–∞–∫—Ä–æ—Å–∞:
*   `Configuration("Key:Path")`: –í—Å—Ç–∞–≤–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ `appsettings.json`.
*   `IncludeFileContent("path/to/file.txt")`: –í—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –∫–∞–∫ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—É—é —Å—Ç—Ä–æ–∫—É.

```yaml
# –°–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö
connections:
  - name: ExampleDbConnection
    type: SqlServer
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–∞–∫—Ä–æ—Å –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
    connectionString: Configuration("ConnectionStrings:DefaultConnection")
    active: true

# –≠–∫–∑–µ–º–ø–ª—è—Ä—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è (–∫–∞–∫–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å–ª—É—à–∞—Ç—å)
trackingInstances:
  - name: EmployeeTracking
    sourceTable: employee
    sourceSchema: dbo
    connection: ExampleDbConnection
    active: true
    checkIntervalInSeconds: 5

# –§–∏–ª—å—Ç—Ä—ã –¥–ª—è –æ—Ç–±–æ—Ä–∞ —Å–æ–±—ã—Ç–∏–π
filters:
  - name: ActiveUsersFilter
    trackingInstance: EmployeeTracking
    type: JsonPathFilter
    parameters:
      # –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è, –≥–¥–µ –ø–æ–ª–µ 'is_active' —Å—Ç–∞–ª–æ false
      expression: "$[?(@.data.new.is_active == false)]"

# –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
transformers:
  - name: AnalyticsTransformer
    trackingInstance: EmployeeTracking
    type: JSONataTransformer
    parameters:
      # –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–∞–∫—Ä–æ—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ª–æ–∂–Ω–æ–≥–æ JSONata-–≤—ã—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Ñ–∞–π–ª–∞
      transformation: IncludeFileContent("transformers/analytics-format.jsonata")

# –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ (–∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ)
receivers:
  - name: EmployeeWebhook
    trackingInstance: EmployeeTracking
    # filter: ActiveUsersFilter           # –ú–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
    # transformer: AnalyticsTransformer # –ú–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä
    type: WebhookReceiver
    parameters:
      webhookUrl: "http://localhost:5123/webhooks/employee"
      httpMethod: POST
```

## üë®‚Äçüíª –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –†–∞–∑—Ä–∞–±–æ—Ç–∫–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

1.  **.NET 8 SDK** –∏–ª–∏ –≤—ã—à–µ.
2.  **IDE**: Visual Studio 2022, JetBrains Rider –∏–ª–∏ VS Code.
3.  **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: SQL Server (–º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ Docker).
4.  **Producer (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**: –ü—Ä–æ–µ–∫—Ç `CdcBridge.Example.WorkerService` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π.
5.  **Listener (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**: –ü—Ä–æ–µ–∫—Ç `WebhookListener` –¥–ª—è –ø—Ä–∏–µ–º–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

*   `CdcBridge.Core`: –ê–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏.
*   `CdcBridge.Configuration`: –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å YAML-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π.
*   `CdcBridge.Persistence`: –°–ª–æ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è (–±—É—Ñ–µ—Ä –Ω–∞ SQLite).
*   `CdcBridge.Application`: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (`SqlServerCdcSource`, `WebhookReceiver` –∏ –¥—Ä.) –∏ DI-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.
*   `CdcBridge.Service`: –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã (–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∏ –≤–æ—Ä–∫–µ—Ä—ã).
*   `CdcBridge.Worker`: –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π –ø—Ä–æ–µ–∫—Ç .NET Worker Service ("–∫–æ—Ä–æ–±–∫–∞").

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –ª–µ–≥–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

#### –ü—Ä–∏–º–µ—Ä: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ü–æ–ª—É—á–∞—Ç–µ–ª—è (IReceiver)

1.  **–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å**, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π `IReceiver`, –≤ –ø—Ä–æ–µ–∫—Ç–µ `CdcBridge.Application` (–∏–ª–∏ –≤ –≤–∞—à–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ).
    ```csharp
    public class MyKafkaReceiver : IReceiver
    {
        public string Name => nameof(MyKafkaReceiver);
        
        public async Task<ReceiverProcessResult> SendAsync(TrackedChange trackedChange, JsonElement parameters)
        {
            // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Kafka...
            return new ReceiverProcessResult { Status = ReceiverProcessStatus.Success };
        }
    }
    ```
2.  **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –µ–≥–æ –≤ DI**. –û—Ç–∫—Ä–æ–π—Ç–µ `CdcBridge.Application/DI/CdcBridgeServiceCollectionExtensions.cs` –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ –º–µ—Ç–æ–¥ `AddCdcBridgeApplicationComponents`:
    ```csharp
    // ...
    services.AddTransient<MyKafkaReceiver>();
    services.AddTransient<IReceiver, MyKafkaReceiver>(s => s.GetRequiredService<MyKafkaReceiver>());
    ```
3.  **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ YAML**:
    ```yaml
    receivers:
      - name: KafkaChannel
        trackingInstance: EmployeeTracking
        type: MyKafkaReceiver # <-- –í–∞—à–∞ –Ω–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
        parameters:
          topic: "user-changes"
          bootstrapServers: "kafka:9092"
    ```
–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `ICdcSource`, `IFilter` –∏ `ITransformer`.

## üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

### –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–î–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ–µ–∫—Ç `CdcBridge.Worker`. –°–æ–±–µ—Ä–∏—Ç–µ –µ–≥–æ –¥–ª—è –Ω—É–∂–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:

```bash
# –î–ª—è Windows x64
dotnet publish CdcBridge.Worker -c Release -r win-x64 --self-contained true

# –î–ª—è Linux x64
dotnet publish CdcBridge.Worker -c Release -r linux-x64 --self-contained true
```

–ö–æ–º–∞–Ω–¥–∞ —Å–æ–∑–¥–∞—Å—Ç –ø–∞–ø–∫—É `publish` —Å–æ –≤—Å–µ–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤ –ø–∞–ø–∫—É `publish` –≤–∞—à–∏ —Ñ–∞–π–ª—ã `appsettings.json` –∏ `cdc-settings.yaml` –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∏—Ö –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω-–æ–∫—Ä—É–∂–µ–Ω–∏—è.

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Windows (–∫–∞–∫ —Å–ª—É–∂–±–∞)

1.  –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏ `publish` –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `C:\CdcBridge`).
2.  –û—Ç–∫—Ä–æ–π—Ç–µ PowerShell –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
3.  –°–æ–∑–¥–∞–π—Ç–µ —Å–ª—É–∂–±—É Windows —Å –ø–æ–º–æ—â—å—é —É—Ç–∏–ª–∏—Ç—ã `sc`:
    ```powershell
    sc.exe create CdcBridge binPath="C:\CdcBridge\CdcBridge.Worker.exe" start=auto
    ```
4.  –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É–∂–±—É:
    ```powershell
    sc.exe start CdcBridge
    ```
    –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏: `sc.exe stop CdcBridge`. –î–ª—è —É–¥–∞–ª–µ–Ω–∏—è: `sc.exe delete CdcBridge`.

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Linux (–∫–∞–∫ systemd —Å–µ—Ä–≤–∏—Å)

1.  –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏ `publish` –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `/opt/cdc-bridge`).
2.  –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è `systemd`:
    ```bash
    sudo nano /etc/systemd/system/cdc-bridge.service
    ```
3.  –í—Å—Ç–∞–≤—å—Ç–µ –≤ –Ω–µ–≥–æ —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, –ø–æ–º–µ–Ω—è–≤ –ø—É—Ç–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
    ```ini
    [Unit]
    Description=CDC Bridge Service

    [Service]
    # –ü—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É
    ExecStart=/opt/cdc-bridge/CdcBridge.Worker
    # –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
    WorkingDirectory=/opt/cdc-bridge
    User=www-data # –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –æ—Ç –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    Restart=always
    RestartSec=10
    SyslogIdentifier=cdc-bridge
    Environment=ASPNETCORE_ENVIRONMENT=Production

    [Install]
    WantedBy=multi-user.target
    ```
4.  –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é `systemd`, –≤–∫–ª—é—á–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:
    ```bash
    sudo systemctl daemon-reload
    sudo systemctl enable cdc-bridge.service
    sudo systemctl start cdc-bridge.service
    ```
    –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞: `sudo systemctl status cdc-bridge`. –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤: `sudo journalctl -u cdc-bridge -f`.

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Docker

1.  –°–æ–∑–¥–∞–π—Ç–µ `Dockerfile` –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ `CdcBridge.Worker`:
    ```dockerfile
    FROM mcr.microsoft.com/dotnet/sdk:8.0 AS build
    WORKDIR /src
    COPY . .
    WORKDIR "/src/CdcBridge.Worker"
    RUN dotnet publish -c Release -o /app/publish --no-restore

    FROM mcr.microsoft.com/dotnet/aspnet:8.0
    WORKDIR /app
    COPY --from=build /app/publish .
    ENTRYPOINT ["dotnet", "CdcBridge.Worker.dll"]
    ```
2.  –°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑:
    ```bash
    docker build -t cdc-bridge .
    ```
3.  –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –ø—Ä–æ–±—Ä–æ—Å–∏–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∫–∞–∫ volume:
    ```bash
    docker run -d --name cdc-bridge-instance \
      -v /path/to/your/configs/appsettings.json:/app/appsettings.json \
      -v /path/to/your/configs/cdc-settings.yaml:/app/cdc-settings.yaml \
      cdc-bridge
    ```